
# 重构


## 代码坏味道(讲义提纲)

## 一、引言

[重构要首先识别代码坏味道](https://github.com/MagicBowen/refactoring/blob/master/effective-refactoring-1.md#%E5%85%B3%E4%BA%8E%E6%9C%AC%E6%96%87)

### 二、《重构》“坏味道”章节

### 三、我们如何识别“坏味道”
##### 1、 Kent Beck简单设计原则
> - 通过所有测试（Passes its tests）
> - 尽可能消除重复 (Minimizes duplication)
> - 尽可能清晰表达 (Maximizes clarity)
> - 更少代码元素 (Has fewer elements)

>  以上四个原则的重要程度依次降低。

##### 2、王博：软件演进式设计与领域建模
偶发成本来源
###### 重复带来偶发成本
> - 确保一致性的成本；
> - 散弹式修改带来的成本；
> - 测试范围扩大带来的成本；

###### 难以理解带来的偶发成本
> - 不知道在哪里修改
> - 不知道怎么修改
> - -》
> - 沟通、溯源成本
> - 理解错误导致修改错误引入更大的成本

###### 冗余带来偶发成本
> - 思维负担
> - 过度设计可引入冗余代码 （当前静态检查工具控制的较好）

##### 总结
按以下目标清除代码坏味道
- **消除重复**：重复代码、
- **提升可读性**：神秘命名、过长函数、过长参数列表、
- **降低耦合**：全局数据、发散式修改与散弹式变化、
- 其它：可变数据；
 

### 四、拓展(重构)
如何重构：“两顶帽子”；-> 小步快跑，尽量拆解为小粒度的原子操作，可及时验证、快速恢复。

何时重构；

重构方法；
