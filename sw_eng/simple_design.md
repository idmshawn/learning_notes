# 简单设计

演进式设计原则： 
保持简单  --》 简单设计

软件设计的核心是降低“偶发成本(Incidental Cost)”，使得成本趋近于内在成本；

### 偶发成本来源
重复带来偶发成本：
- 确保一致性的成本；
- 散弹式修改带来的成本；
- 测试范围扩大带来的成本；

难以理解带来的偶发成本：
- 不知道在哪里修改
- 不知道怎么修改
- -》
- 沟通、溯源成本
- 理解错误导致修改错误引入更大的成本

冗余带来偶发成本
- 思维负担
- **过度设计**可引入冗余代码
（当前静态检查工具控制的较好）

### 简单设计原则
(Kent Beck提出)
1. 通过所有测试（Passes its tests）
2. 尽可能消除重复 (Minimizes duplication)：代码可复用度高
3. 尽可能清晰表达 (Maximizes clarity)
4. 更少代码元素 (Has fewer elements) :  避免过度设计
以上四个原则的重要程度依次降低。

四原则同样可评判领域建模等软件相关设计xx


# 设计原则

### 消除重复的设计原则
- 消除重复的关键：分离不同的变化方向；分离变化的关键是**确定接口**；
- 接口的设计原则：最小依赖原则；
- 接口的依赖原则：向稳定的方向依赖；

### 消除重复的手段
##### 数据变化
1. 数据参数化
2. 参数结构化
3. 结构模型化
#### 行为变化
1. 提炼接口
2. 不变的部分面向接口编程
3. 变化点面向接口拓展
4. 根据上下文选择和组合

本质是行为数据化，于是行为可以类似数据一样参数化，根据需要创建、转移、存储和延迟使用。
##### 类型变化
类型变化
- C++：模板；
- C语言：宏
本质是类型数据化，于是类型可以类似数据一样参数化，根据需要创建、转移、存储和延迟使用（泛型编程和元编程）。


# 重构技术(Refactoring)

重构的关键：小步快跑。

尽量拆解为小粒度的原子操作，可及时验证、快速恢复。


# 编程范式 之 面向对象范式
### 面向对象设计原则
SOLID(核心是对多态的设计原则)
- **S**ingle responsibility principle：单一职责原则；
通过接口分离变和不变，隔离变化；
- The **O**pen/Closed Principle：开闭原则；
“软件中的对象（类，模块，函数等等）应该对于扩展是开放的，但是对于修改是封闭的”；
多态的目标在于系统对于变化的拓展而非修改；
- **L**iskov Substitution principle：里式替换原则；
“派生类（子类）对象可以在程序中代替其基类（超类）对象。”
接口设计要达到类型擦除的圆满效果；
- **I**nterface-segregation principles：接口隔离原则；
面向不同客户的接口要分离开；
- **D**ependency inversion principle: 依赖倒置原则；
接口的设计和规定者应该是接口的使用方；

### 面向对象设计模式
GoF的23中模式，可分三类。
##### 创建
##### 结构
##### 行为

### 面向对象建模
- 需求建模：usecase(场景视图)
- 分析建模：分析模型(逻辑视图)，OOA(面向对象分析)过程，可使用[四色建模](https://en.wikipedia.org/wiki/Object_Modeling_in_Color)完成（有四种颜色能区分即可，哪种颜色对应哪类对象模型不强制）
> - 绿：Party,Place,Thing，人、事、物
> - 黄：Role，绿色对象(人、事、物)参与活动的方式；可理解为动作；
> - 粉：Moment-Interval，时标性对象，写法一般是名词+动词的被动态，比如Command Executed；可理解为状态；
> - 蓝：Description，附加描述；
- 设计建模：设计模型(设计模式，其它视图)
- 代码实现：面向对象编码
